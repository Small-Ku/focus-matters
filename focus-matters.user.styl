/* ==UserStyle==
@name           Focus matters
@namespace      https://github.com/Small-Ku/focus-matters
@version        0.2.0-dev+003
@description    A simple user css for Matters
@author         Small-Ku <small_ku@outlook.com> (https://github.com/Small-Ku)
@license		MIT
@homepageURL	https://github.com/Small-Ku/focus-matters
@supportURL		https://github.com/Small-Ku/focus-matters/issues
@updateURL 		https://raw.githubusercontent.com/Small-Ku/focus-matters/master/focus-matters.user.styl
@preprocessor   stylus

@var			select   layoutChange    "擴大內容" [
					"focusMatters:專注內容",
					"mockOriginal:仿製原版",
					"off:關閉"
				]
@var			checkbox lookOptimize    "視覺優化"  1
==/UserStyle== */

@-moz-document domain("matters.news")
	// 視覺優化
	// Optimize appearance
	if lookOptimize
		// 優化圓角元素的視覺平衡
		// Optimize padding of round text elements with icon
		.tag
			padding 0 0.5rem 0 0.25rem!important
		.side-nav .hasIcon.text-right .text
			padding 0 0.25rem 0 0.5rem!important
		.side-nav .hasIcon.text-right.white .text
			padding 0 0rem 0 0.5rem!important

		// 爲開關按鈕換更好的動畫
		// Optimize switch with transform instead of box-shadow and left/right
		.switch input
			& + span
				overflow hidden
				&:before, &:after
					transition transform .1s cubic-bezier(0.4, 0.0, 0.2, 1)!important
				&:before
					display block
					position absolute
					left 0
					right 0
					top 0
					bottom 0
					width 100%
					height 100%
					z-index 0
					content ""
					background-color rgb(13, 103, 99)
					transform translateX(-2.3rem)
					border-radius .75rem
				&:after
					z-index 1
			&:checked + span
				box-shadow none!important
				&:before
					opacity 1
					transform translateX(0)
				&:after 
					right auto !important
					transform translateX(1.125rem) !important

	// 擴大內容
	// Extend content in the web layout
	if layoutChange != off
		@media (min-width: 1280px)
			#__next
				& > main
					-webkit-flex-basis 100%
					-ms-flex-preferred-size 100%
					flex-basis 100%
					max-width 100%
					// 模仿原版佈局
					// Mock original layout
					if layoutChange == mockOriginal
						& > article
							max-width calc(100% - 520px) !important
							flex-basis calc(100% - 520px) !important
						& > nav
							max-width 168px !important
							padding-left 72px !important
						& > aside
							max-width 272px !important
							padding-right 72px !important
					// 自創佈局
					// Focus Matters style
					if layoutChange == focusMatters
						& > article
							max-width calc(100% - 25rem) !important
							flex-basis calc(100% - 25rem) !important
							padding 0 !important
							margin-right 2rem !important
						& > nav
							max-width 8rem
							margin 0 0 0 2rem
						& > aside
							max-width 12rem
							flex-basis 12rem
							padding-right 1rem !important
						& > aside, & > nav
							opacity 1
							transform translateX(0)
							transition opacity .25s, transform .3s
							transition-time-function cubic-bezier(0.4, 0.0, 1, 1)

		// 修復自創佈局中的卡片層級
		// Fix z-index of poped cards when searching
		.tippy-popper
			z-index 200 !important

@-moz-document regexp("https:\/\/matters\.news\/@.+\/((?!comments|followe[re]s).+)")
	// 自創佈局
	// Focus Matters style
	if layoutChange == focusMatters
		@media (min-width: 1280px)
			#__next > main
				// 隱藏導航欄與側邊欄，滑鼠置於空白位置時浮現
				// Hide nav and aside with revealing with hover
				& > aside, & > nav
					opacity 0
					transition opacity .25s
					transition-time-function cubic-bezier(0.4, 0.0, 1, 1)
					&:hover, &:focus-within
						opacity 1
						transition opacity .3s
						transition-time-function cubic-bezier(0.0, 0.0, 0.2, 1)
				// 內縮右移側邊欄
				// Hide aside in the right
				& > aside
					max-width 16rem
					flex-basis 16rem
					position fixed
					right 0
					padding 2rem 1rem
					height 100%
					z-index 150 !important
					background #fff
					transform translateX(40%) !important
					transition opacity .25s, transform .25s
					border-left 1px solid rgba(0,0,0,0.08)
					& > *
						width 14rem
						flex-basis 14rem
					&:hover, &:focus-within
						transform translateX(0) !important
						transition opacity .3s, transform .3s
				// 擴大內容區域
				// Extend content area more
				& > article
					max-width calc(100% - 20rem) !important
					flex-basis calc(100% - 20rem) !important
